# sha256.c 文档

## 文件概述
`sha256.c` 是一个实现 SHA-256 和 SHA-224 哈希算法的库文件，提供对输入数据的哈希计算功能。该文件是 `libcc` 项目的一部分，遵循开源许可证（见文件头部注释）。

## 主要功能

### 1. SHA-256 和 SHA-224 算法实现
- **SHA-256 原理**：
  - 输入任意长度的数据，输出固定长度（256 位）的哈希值。
  - 适用于数据完整性校验和密码学安全场景。
- **SHA-224 原理**：
  - 基于 SHA-256，但输出长度为 224 位。

### 2. 核心函数
- **函数**: `_cc_sha256_init`
  - 初始化 SHA-256 或 SHA-224 上下文，设置初始状态。
  - 参数：
    - `ctx`: SHA-256 上下文结构体指针。
    - `is224`: 是否为 SHA-224 模式（`true` 表示 SHA-224，`false` 表示 SHA-256）。

- **函数**: `_cc_sha256_process`
  - 处理 64 字节的数据块，更新哈希状态。
  - 参数：
    - `ctx`: SHA-256 上下文结构体指针。
    - `data`: 输入数据块。

- **函数**: `_cc_sha256_update`
  - 更新哈希计算，输入任意长度的数据。
  - 参数：
    - `ctx`: SHA-256 上下文结构体指针。
    - `input`: 输入数据。
    - `ilen`: 输入数据长度。

- **函数**: `_cc_sha256_final`
  - 完成哈希计算，输出最终的哈希值。
  - 参数：
    - `ctx`: SHA-256 上下文结构体指针。
    - `output`: 输出缓冲区（32 字节或 28 字节）。

- **函数**: `_cc_sha256`
  - 封装 SHA-256 或 SHA-224 计算的完整流程（初始化、更新、完成）。
  - 参数：
    - `input`: 输入数据。
    - `ilen`: 输入数据长度。
    - `output`: 输出缓冲区（十六进制字符串）。
    - `is224`: 是否为 SHA-224 模式。

### 3. 文件哈希计算
- **函数**: `_cc_sha256_fp`
  - 计算文件的 SHA-256 或 SHA-224 哈希值。
  - 参数：
    - `fp`: 文件指针。
    - `output`: 输出缓冲区（十六进制字符串）。
    - `is224`: 是否为 SHA-224 模式。
  - 返回值：成功返回 `true`，失败返回 `false`。

- **函数**: `_cc_sha256file`
  - 计算指定文件的 SHA-256 或 SHA-224 哈希值。
  - 参数：
    - `filename`: 文件路径。
    - `output`: 输出缓冲区（十六进制字符串）。
    - `is224`: 是否为 SHA-224 模式。
  - 返回值：成功返回 `true`，失败返回 `false`。

## 使用示例

### 示例 1：计算字符串的 SHA-256 哈希值
```c
#include <libcc/crypto/sha.h>

int main() {
    const byte_t input[] = "Hello, SHA-256!";
    tchar_t output[65]; // SHA-256 输出为 64 字符（32 字节）

    _cc_sha256(input, strlen(input), output, false);
    printf("SHA-256: %s\n", output);

    return 0;
}
```

### 示例 2：计算文件的 SHA-224 哈希值
```c
#include <libcc/crypto/sha.h>

int main() {
    tchar_t output[57]; // SHA-224 输出为 56 字符（28 字节）

    if (_cc_sha256file("/path/to/file", output, true)) {
        printf("File SHA-224: %s\n", output);
    }

    return 0;
}
```

## 注意事项
1. **安全性**：SHA-256 和 SHA-224 是密码学安全的哈希算法，适用于数据完整性校验和密码学场景。
2. **性能**：哈希计算速度较快，适合高频使用。
3. **内存管理**：调用者需确保输入数据的生命周期与哈希计算过程一致。

## 许可证
该文件遵循开源许可证，详细信息请参考文件头部的注释。